1
00:00:00,000 --> 00:00:01,679
LVM (Logical Volume Manager)

2
00:00:03,679 --> 00:00:05,719
Administrador de Volúmenes Lógicos

3
00:00:07,719 --> 00:00:11,199
Escenario para hacer la práctica de particiones con el LVM

4
00:00:13,199 --> 00:00:13,800
Escenario:

5
00:00:15,799 --> 00:00:25,639
    • Una computadora con una instalación estándar de Linux (En este caso un Linux Debian 12, no es necesario que la instalación sea sobre una partición con un LVM)

6
00:00:27,639 --> 00:00:35,559
    • Agregar un nuevo dispositivo de almacenamiento a la computadora (En esta práctica se ha agregado un SSD Kingston SA400S37240G)

7
00:00:37,559 --> 00:00:45,479
    • El dispositivo se particionará en tres particiones para simular la existencia de tres dispositivos de almacenamientos físicos.

8
00:00:47,479 --> 00:00:53,839
En realidad a los servidores se les agregan varios dispositivos de almacenamientos físicos en sus bahías. 

9
00:00:55,839 --> 00:01:06,639
Los formatos de los Dispositivos de almacenamientos, normalmente, son: Dispositivo de Discos Duros (HDD Hard Drive Disk),  y Dispositivo de Estado Sólido, (SSD Solid State Drive). 

10
00:01:08,639 --> 00:01:13,440
Se hará la practica con el VLM en el nuevo dispositivo de almacenamiento físico.

11
00:01:15,440 --> 00:01:17,180
Capa de abstracción en un LVM

12
00:01:19,180 --> 00:01:28,239
El LVM proporciona una capa de abstracción entre los dispositivos de almacenamiento físico y los sistemas de archivos de los Sistemas Operativos Linux.

13
00:01:30,239 --> 00:01:38,519
Un LVM permite cambiar el tamaño de los sistemas de archivos de forma dinámica y escalar el sistema según las necesidades de los usuarios.

14
00:01:40,519 --> 00:01:41,959
Conceptos Básicos de LVM

15
00:01:43,959 --> 00:01:50,139
    1. Physical Volume (PV): Un PV es un dispositivo de almacenamiento físico inicializado para su uso.

16
00:01:52,139 --> 00:01:58,800
    2. Volume Group (VG): Un VG agrupa varios PVs. Es un contenedor de uno o más PVs. Pueden existir varios VG.

17
00:02:00,800 --> 00:02:10,339
    3. Logical Volume (LV): Un LV es una porción de espacio de almacenamiento dentro de un VG, se puede formatear y usar como si fuera un Disco Duro o un SSD. 

18
00:02:12,339 --> 00:02:21,459
Los LV funcionan como Discos Fijos o SSD virtuales, fáciles de gestionar y mantener según las necesidades de escalabilidad de los usuarios del sistema. 

19
00:02:23,459 --> 00:02:29,099
Los LV pueden cambiar su tamaño de forma dinámica y a demanda ofreciendo un sistema escalable.

20
00:02:31,099 --> 00:02:39,319
Con el comando lsblk se puede listar todas las unidades de almacenamiento y ver todos los puntos de montaje a las particiones existentes.

21
00:02:41,319 --> 00:02:46,599
Los puntos de montajes se realizan sobre las carpetas del sistema de archivos anfitrión.

22
00:02:48,599 --> 00:02:54,179
El sistema de archivo anfitrión tiene el Sistema Operativo que ha arrancado la computadora.  

23
00:02:56,179 --> 00:02:59,059
Ejecutar cualquiera de los siguientes comandos: 

24
00:03:01,059 --> 00:03:01,479
$ lsblk

25
00:03:03,479 --> 00:03:04,080
$ lsblk -f

26
00:03:06,080 --> 00:03:08,419
$ lsblk -o name,size,fstype,mountpoints

27
00:03:10,419 --> 00:03:11,440
$ lsblk /dev/sda 

28
00:03:13,440 --> 00:03:17,520
En el informe podemos ver las siguientes unidades de almacenamiento:

29
00:03:19,520 --> 00:03:27,620
    1. Las unidades loopx son unidades virtuales que se montaron sobre carpetas del sistema de archivo del Sistema Operativo anfitrión.

30
00:03:29,620 --> 00:03:37,960
    2. Hay una unidad física llamada sda que no tiene particiones físicas, por lo tanto no tiene sistema de archivos ni puntos de montajes.

31
00:03:39,960 --> 00:03:52,500
    3. La unidad física llamada nvme0n1 tiene tres particiones físicas llamadas p1, p2 y p3 respectivamente. Cada una de las particiones tiene un sistema de archivo específico y su respectivo punto de montaje.

32
00:03:54,500 --> 00:03:58,339
    4. La unidad física llamada nvme0n1 es la unidad anfitriona.

33
00:04:00,339 --> 00:04:04,660
Para ver los dispositivos de almacenamiento de forma gráfica, ejecutar: 

34
00:04:06,660 --> 00:04:07,559
$ gnome-disks  

35
00:04:09,559 --> 00:04:17,959
En la imagen podemos ver el dispositivo físico de almacenamiento anfitrión, este dispositivo tiene instalado el Sistema Operativo anfitrión.

36
00:04:19,959 --> 00:04:25,419
El dispositivo de almacenamiento y el Sistema Operativo anfitrión arrancan la computadora. 

37
00:04:27,419 --> 00:04:35,459
Es conveniente no trabajar sobre este dispositivo ya que la computadora podría tener pérdida de información y no arrancar normalmente.

38
00:04:37,459 --> 00:04:43,399
En la siguiente imagen podemos ver el nuevo dispositivo físico de almacenamiento llamado /dev/sda. 

39
00:04:45,399 --> 00:04:51,759
El nuevo dispositivo no tiene ninguna partición física creada o no tiene un sistema de archivo formateado.

40
00:04:53,759 --> 00:05:03,359
Los discos nuevos normalmente tienen una única partición estándar definida por el fabricante , y se necesitará formatear la partición con un sistema de archivo.

41
00:05:05,359 --> 00:05:09,259
El sistema de archivo es particular para cada Sistema Operativo. 

42
00:05:11,259 --> 00:05:21,039
Se deberá crear una o varias particiones físicas, para hacer las prácticas con el LVM. La idea es simular varios dispositivos físico reales con dichas particiones.

43
00:05:23,039 --> 00:05:29,519
En el futuro se podrán agregar nuevos dispositivos de almacenamiento físico con nuevas particiones físicas. 

44
00:05:31,519 --> 00:05:49,819
El LVM podrá brindar almacenamiento de forma dinámica a los antiguos usuarios corporativos o brindar nuevo espacio de almacenamiento a los nuevos usuario corporativos de forma gestionada, escalable, confiable, resiliencia, sencilla y rápida.                                                                

45
00:05:51,819 --> 00:05:54,819
Preparando el nuevo dispositivo de almacenamientos

46
00:05:56,819 --> 00:06:04,199
Crear 3 particiones físicas, para crear particiones físicas podemos usar el comando fdisk o la aplicación gráfica Gparted. 

47
00:06:06,199 --> 00:06:07,579
Usando el comando fdisk

48
00:06:09,579 --> 00:06:17,500
Ejecutar el siguiente comando para abrir la interfaz de gestión de particiones de Linux, en este caso será la partición llamada sda.

49
00:06:19,500 --> 00:06:20,760
$ sudo fdisk /dev/sda

50
00:06:22,760 --> 00:06:27,140
Escribimos el comando ‘p’ para verificar que estamos en el disco correcto

51
00:06:29,140 --> 00:06:33,640
Escribimos el comando ‘F’ para ver si hay espacio para nuevas particiones. 

52
00:06:35,640 --> 00:06:40,740
En este caso como es un SSD nuevo, dispondrá de todo el SSD para nuevas particiones. 

53
00:06:42,740 --> 00:06:46,880
En caso de querer borrar particiones existentes usar el comando ‘d’  

54
00:06:48,880 --> 00:06:55,900
También se puede usar el comando ‘v’ y el comando ‘i’ para verificar errores y verificar las particiones existentes. 

55
00:06:57,900 --> 00:07:06,720
En este caso es un SSD nuevo, se supone que no tendrá errores y no tendrá particiones disponibles o las que tendría fueron borradas por seguridad. 

56
00:07:08,720 --> 00:07:18,260
Si realmente desea borrar una partición se podrá usar el comando ‘d’, en este caso al intentar borra una partición, informa que no hay particiones para borrar.

57
00:07:20,260 --> 00:07:22,120
Orden (m para obtener ayuda): d

58
00:07:24,120 --> 00:07:26,220
¡No hay ninguna partición definida!

59
00:07:28,220 --> 00:07:31,700
Para crear una partición debemos ejecutar el comando ‘n’. 

60
00:07:33,700 --> 00:07:41,740
En la siguiente tarea usando el comando ‘n’ se crearon tres particiones de 50 Giga Bytes y se dejó sin particionar el resto del disco.

61
00:07:43,740 --> 00:07:51,120
Para escribir los cambios realmente en el SSD hay que usar el comando ‘w’, en caso de arrepentimiento usar el comando ‘q’. 

62
00:07:53,120 --> 00:08:00,920
Ambos comandos regresan a la terminal de Linux.                                                                                   

63
00:08:02,920 --> 00:08:15,220
Formateando las nuevas particiones, no es necesario formatear las nuevas particiones ya que LVM dará su propio formato de archivo. De todas formas las particiones podrían formatearse de la siguiente forma:

64
00:08:17,220 --> 00:08:21,600
Ejecutar los siguientes comandos para formatear las particiones 1, 2 y 3:

65
00:08:23,600 --> 00:08:27,200
$ sudo mkfs.ext4 /dev/sda1  # Formatea la primera partición.

66
00:08:29,200 --> 00:08:32,800
$ sudo mkfs.ext4 /dev/sda2  # Formatea la segunda partición.

67
00:08:34,800 --> 00:08:38,400
$ sudo mkfs.ext4 /dev/sda3  # Formatea la tercera partición.

68
00:08:40,400 --> 00:08:58,160
En este momento si se arrepiente de querer instalar el sistema de Gestión de Volúmenes Lógicos, VLM, podrá montar las particiones en un directorio de su dispositivo de almacenamiento anfitrión y comenzar a usar el nuevo dispositivo de forma normal.                                                

69
00:09:00,160 --> 00:09:04,840
Estos son los comandos para montar las tres particiones para usar normalmente.

70
00:09:06,840 --> 00:09:10,800
Crear tres directorios en su sistema de almacenamiento anfitrión. 

71
00:09:12,800 --> 00:09:14,180
$ sudo mkdir /mnt/part1

72
00:09:16,180 --> 00:09:17,560
$ sudo mkdir /mnt/part2

73
00:09:19,560 --> 00:09:20,940
$ sudo mkdir /mnt/part3

74
00:09:22,940 --> 00:09:25,880
Montar las particiones en los nuevos directorio. 

75
00:09:27,880 --> 00:09:34,480
También puede usar viejos directorios o carpetas que ha creado en el pasado en su Sistema Operativo anfitrión.

76
00:09:36,480 --> 00:09:38,460
$ sudo mount /dev/sda1 /mnt/part1

77
00:09:40,460 --> 00:09:42,440
$ sudo mount /dev/sda2 /mnt/part2

78
00:09:44,440 --> 00:09:46,479
$ sudo mount /dev/sda3 /mnt/part3 

79
00:09:48,479 --> 00:09:57,419
La siguiente imagen muestra el administrador de archivos y directorios Nautilus con las tres carpetas montadas en las tres particiones del nuevo SSD.

80
00:09:59,419 --> 00:10:07,279
Si los puntos de montaje quedaron de solo lectura, deberá usar Nautilus como administrador root o una terminal como super-usuario. 

81
00:10:09,279 --> 00:10:14,439
Podrá darle los permisos de lectura y escritura a otros usuarios o grupos de usuarios.

82
00:10:16,439 --> 00:10:26,639
Para poder ejecutar Nautilus como administrador usando el botón derecho del ratón hay que instalar todas las extensiones de Nautilus desde el gestor de paquetes Synaptic.

83
00:10:28,639 --> 00:10:43,759
Si ha instalado todas las extensiones de Nautilus y también ha instalado y configurado correctamente la aplicación Samba desde el gestor de paquetes Synaptic podrá compartir las carpetas que son puntos de montajes en la red LAN o en la red de Intranet.

84
00:10:45,759 --> 00:10:55,659
También podrá instalar Gparted desde el almacén de aplicaciones de Debian o desde el gestor de paquetes Synaptic o usando el comando apt-get desde la terminal Linux.

85
00:10:57,659 --> 00:11:03,419
En la siguiente imagen vemos la aplicación Discos de Linux Debian informando la tarea realizada.

86
00:11:05,419 --> 00:11:10,639
En la siguiente imagen podemos ver la aplicación Gparted informando la tarea realizada.

87
00:11:12,639 --> 00:11:24,759
Podrá hacer las mismas tareas realizadas con el comando fdisk usando de forma combinada las interfaces gráficas de la aplicación Discos de Linux Debian y de la aplicación Gparted.                       

88
00:11:26,759 --> 00:11:33,779
Para instalar el sistema de Gestión de Volúmenes Lógicos, VLM, las particiones físicas tendrán que estar desmontadas.

89
00:11:35,779 --> 00:11:43,279
Para desmontar las particiones ejecutar los siguientes comandos o utilizar las aplicaciones Discos de Linux Debian o Gparted:

90
00:11:45,279 --> 00:11:46,719
$ sudo umount /mnt/part1

91
00:11:48,719 --> 00:11:50,159
$ sudo umount /mnt/part2

92
00:11:52,159 --> 00:11:53,599
$ sudo umount /mnt/part3

93
00:11:55,599 --> 00:11:56,619
Instalando el VLM

94
00:11:58,619 --> 00:12:05,700
Crear discos virtuales con el Gestor de Volúmenes Lógico, LVM, en la unidad de almacenamiento física SSD, llamada sda.

95
00:12:07,700 --> 00:12:14,119
En realidad no interesa si el nuevo sistema de almacenamientos SSD tiene una o varias particiones físicas. 

96
00:12:16,119 --> 00:12:27,700
El LVM se instala como una capa de abstracción y oculta la realidad a los Sistemas Operativos Linux sobre la configuración subyacente del hardware.                                              

97
00:12:29,700 --> 00:12:37,260
Paso 01 – Iniciar Volúmenes Físicos, PV, dado uno o varios dispositivos de almacenamientos o una o varias particiones físicas.

98
00:12:39,260 --> 00:12:46,220
Ver las configuraciones actuales del sistema de almacenamiento, ejecutar los siguientes comandos o utilizar Gparted:

99
00:12:48,220 --> 00:12:48,820
Ejecutar: 

100
00:12:50,820 --> 00:12:51,239
$ lsblk

101
00:12:53,239 --> 00:12:53,839
$ lsblk -f

102
00:12:55,839 --> 00:12:58,179
$ lsblk -o name,size,fstype,mountpoints

103
00:13:00,179 --> 00:13:01,200
$ lsblk /dev/sda 

104
00:13:03,200 --> 00:13:09,320
Trabajaremos con la unidad de almacenamiento llamada sda y sus particiones llamadas sda1, sda2 y sda3.

105
00:13:11,320 --> 00:13:14,799
Iniciar uno o varios PV, ejecutar los siguientes comandos:

106
00:13:16,799 --> 00:13:18,299
$ sudo pvcreate /dev/sda1

107
00:13:20,299 --> 00:13:21,799
$ sudo pvcreate /dev/sda2

108
00:13:23,799 --> 00:13:25,839
$ sudo pvcreate /dev/sda3         

109
00:13:27,839 --> 00:13:34,979
Cada vez que se ejecute el comando pvcreate se creará un PV que luego se agrupará en un Grupo de Volúmenes Fsicos, VG. 

110
00:13:36,979 --> 00:13:41,299
También es factible crear uno o varios VG que agruparan uno o varios PV.

111
00:13:43,299 --> 00:13:48,940
El comando pvcreate se utiliza para inicializar un disco o una partición para su uso con LVM. 

112
00:13:50,940 --> 00:13:57,659
Se puede ejecutar tanto sobre un dispositivo de almacenamiento completo (por ejemplo, $ sudo pvcreate /dev/sda) 

113
00:13:59,659 --> 00:14:05,059
Se puede ejecutar sobre una partición específica (por ejemplo, $ sudo pvcreate /dev/sda1).

114
00:14:07,059 --> 00:14:11,320
Usando el comando pvcreate en un dispositivo de almacenamiento completo

115
00:14:13,320 --> 00:14:21,419
Los discos nuevos traen una partición por defecto y es factible usar el siguiente comando: $ sudo pvcreate /dev/<nombre de la unidad>. 

116
00:14:23,419 --> 00:14:29,599
Si es un disco usado es factible usar alguna de sus particiones existentes e ignorar otras particiones.

117
00:14:31,599 --> 00:14:34,179
Usando pvcreate en una partición específica

118
00:14:36,179 --> 00:14:42,000
Si se prefiere utilizar un nuevo particionamiento del dispositivo de almacenamiento para el LVM. 

119
00:14:44,000 --> 00:14:52,280
Primero se debe crear una partición en el dispositivo utilizando una herramienta como fdisk. Luego ejecutar pvcreate sobre esa partición. 

120
00:14:54,280 --> 00:14:57,460
También es factible utilizar una partición existente.

121
00:14:59,460 --> 00:15:05,100
El comando pvcreate permite inicializar múltiples dispositivos o particiones al mismo tiempo. 

122
00:15:07,100 --> 00:15:07,580
Ejemplo:

123
00:15:09,580 --> 00:15:16,660
Para inicializar /dev/sda, /dev/sdb y la partición /dev/sdc2 para su uso con LVM, se puede usar el siguiente comando: 

124
00:15:18,660 --> 00:15:21,240
$ sudo pvcreate /dev/sda /dev/sdb /dev/sdc2

125
00:15:23,240 --> 00:15:23,960
Explicación:

126
00:15:25,960 --> 00:15:29,980
/dev/sda: Inicializa el primer disco completo /dev/sda para el LVM.

127
00:15:31,980 --> 00:15:36,060
/dev/sdb: Inicializa el segundo disco completo /dev/sdb para el LVM.

128
00:15:38,060 --> 00:15:42,920
/dev/sdc2: Inicializa la segunda partición del tercer disco /dev/sdc para el LVM.

129
00:15:44,920 --> 00:15:45,640
Verificación

130
00:15:47,640 --> 00:15:56,760
Después de ejecutar pvcreate, se puede verificar que los dispositivos y particiones se han inicializado correctamente usando el comando pvs o pvdisplay:

131
00:15:58,760 --> 00:16:10,580
Estos comandos, pvs o pvdisplay, mostrarán información sobre los volúmenes físicos (PVs). Confirmando que todos los dispositivos y particiones se han inicializado correctamente para su uso con LVM.

132
00:16:12,580 --> 00:16:14,200
Consideraciones Adicionales

133
00:16:16,200 --> 00:16:25,440
Backup de Datos: Verificar que los dispositivos y particiones no contengan datos importantes, ya que pvcreate puede sobrescribir la información existente.

134
00:16:27,440 --> 00:16:32,780
Permisos de Super-usuario: Ejecutar pvcreate con permisos de super-usuario (usando sudo).

135
00:16:34,780 --> 00:16:38,620
Escribir $ sudo pvs --help para ver más opciones del comando pvs

136
00:16:40,620 --> 00:16:48,480
Paso 02 - El paso siguiente es crear los grupos de volúmenes lógicos. Para crear uno o varios VG, ejecutar los siguientes comandos:

137
00:16:50,480 --> 00:16:54,860
$ sudo vgcreate clientes-web-con-soporte /dev/sda1 /dev/sda2             

138
00:16:56,860 --> 00:16:59,860
$ sudo vgcreate clientes-web-sin-soporte /dev/sda3

139
00:17:01,860 --> 00:17:09,960
Estos comando crearán dos grupos de volúmenes lógicos con la intención de gestionar los recursos asignados a dos tipos de clientes Web.

140
00:17:11,960 --> 00:17:17,000
Para ver la tarea realizada podemos ejecutar cualquiera de los siguientes comandos: 

141
00:17:19,000 --> 00:17:19,600
$ sudo pvs

142
00:17:21,600 --> 00:17:22,200
$ sudo vgs

143
00:17:24,200 --> 00:17:29,060
Paso 03 - Crear Volúmenes Lógicos, LV, dados los Grupos de Volúmenes Físicos, VG.

144
00:17:31,060 --> 00:17:39,040
Los  LV deben montarse sobre directorios creados en el Sistema Operativo anfitrión, crear dos directorio con los siguientes comandos:

145
00:17:41,040 --> 00:17:43,560
$ sudo mkdir /mnt/LV-ClientesWebConSoporte

146
00:17:45,560 --> 00:17:48,080
$ sudo mkdir /mnt/LV-ClientesWebSinSoporte

147
00:17:50,080 --> 00:17:52,540
Crear los LV con los siguientes comandos:

148
00:17:54,540 --> 00:17:59,160
$ sudo lvcreate -l 50%VG -n clientes-web-con-soporte/LV-ClientesWebConSoporte

149
00:18:01,160 --> 00:18:05,780
$ sudo lvcreate -l 50%VG -n clientes-web-sin-soporte/LV-ClientesWebSinSoporte

150
00:18:07,780 --> 00:18:20,140
Hay que tener en cuenta que el VG llamado clientes-web-con-soporte tiene asociado dos particiones llamadas sda1 y sda2 y que el VG llamado clientes-web-sin-soporte tiene asociado una partición llamada sda3 

151
00:18:22,140 --> 00:18:30,900
Si cada partición tiene 50 Gigas de espacio, entonces el punto de montaje llamado LV-ClientesWebConSoporte tendrá 100 Gigas de espacio disponible.

152
00:18:32,900 --> 00:18:38,479
El punto de montaje llamado LV-ClientesWebConSinSorte tendrá 50 Gigas de espacio disponible. 

153
00:18:40,479 --> 00:18:47,020
Del espacio disponible solamente se ha asignado el 50 por ciento, en el futuro se podrá asignar más espacio. 

154
00:18:49,020 --> 00:18:54,119
En caso que se agote el espacio disponible se tendrá que cambiar el tamaño de los LV.

155
00:18:56,119 --> 00:19:04,400
En caso que se agotara el espacio físico para agrandar el espacio de los LV, se tendrá que instalar nuevos dispositivos de almacenamiento.

156
00:19:06,400 --> 00:19:10,960
En la siguiente imagen podemos ver pintado de amarillo el espacio asignado. 

157
00:19:12,960 --> 00:19:15,420
Pintado de blanco el espacio disponible. 

158
00:19:17,420 --> 00:19:22,700
Pintado de gris el espacio no particionado y que en el futuro se podría agregar al VLM. 

159
00:19:24,700 --> 00:19:32,440
Siempre se podrán agregar nuevos dispositivos y particiones para escalar el sistema VLM según las necesidades de los usuarios.   

160
00:19:34,440 --> 00:19:39,660
Hay que recordad que sda1 y sda2 pertenecen a un grupo que tiene disponible 100 Gigas. 

161
00:19:41,660 --> 00:19:52,280
De los cuales se ha usado el 50 por ciento. La partición sda3 pertenece a otro grupo que solamente dispone de 50 Gigas, y que se han asignado de esos 50 Gigas el 50 por cientos.

162
00:19:54,280 --> 00:19:58,719
Para obtener la ayuda del comando lvcreate, ejecutar el siguiente comando:

163
00:20:00,719 --> 00:20:02,039
$ sudo lvcreate --help

164
00:20:04,039 --> 00:20:10,819
Para ver la tarea realizada ejecutar los siguientes comandos o usar la aplicación Discos o la aplicación Gparted:

165
00:20:12,819 --> 00:20:13,239
$ lsblk

166
00:20:15,239 --> 00:20:16,199
$ sudo lvdisplay

167
00:20:18,199 --> 00:20:19,159
$ sudo vgdisplay

168
00:20:21,159 --> 00:20:22,119
$ sudo pvdisplay

169
00:20:24,119 --> 00:20:24,719
$ sudo lvs

170
00:20:26,719 --> 00:20:27,319
$ sudo vgs

171
00:20:29,319 --> 00:20:29,919
$ sudo pvs

172
00:20:31,919 --> 00:20:41,279
Si el uso de la terminal resulta muy complejo para trabajar con VLM, en realidad muchas de las tareas realizadas se pueden hacer con la aplicación Gparted. 

173
00:20:43,279 --> 00:20:52,339
En algunas circunstancias por razones de protección de datos Gparted no permite borrar algunas particiones físicas, pero si permite cambiar su tamaño. 

174
00:20:54,339 --> 00:20:59,559
De todas formas Gparted no trabaja con los sistemas de archivos de los PV, VG y los LV.

175
00:21:01,559 --> 00:21:12,899
¡Atento! No intente cambiar el tamaño de las particiones físicas con Gparted, se ha configurado el sistema LVM para dejar de hacer la tarea de cambiar el tamaño de las particiones físicas. 

176
00:21:14,899 --> 00:21:25,159
Hay que cambiar el tamaño de los VL, si es que existe espacio para asignar, si no queda espacio para asignar deberá agregar nuevos dispositivos de almacenamiento físicos. 

177
00:21:27,159 --> 00:21:38,199
El siguiente paso es formatear los VL, ejecutar los siguientes comandos para formatear los VL:                                                                                          

178
00:21:40,199 --> 00:21:44,459
$ sudo mkfs.ext4 /dev/clientes-web-sin-soporte/LV-ClientesWebSinSoporte

179
00:21:46,459 --> 00:21:50,719
$ sudo mkfs.ext4 /dev/clientes-web-con-soporte/LV-ClientesWebConSoporte

180
00:21:52,719 --> 00:21:57,939
El paso siguiente es montar los dispositivos de almacenamientos virtuales para su uso. 

181
00:21:59,939 --> 00:22:09,059
Hay que recordad que se deben desmontar los almacenamientos virtuales si se desea cambiar los tamaños de los espacios asignados o el tamaño de los VL.  

182
00:22:11,059 --> 00:22:16,879
$ sudo mount /dev/clientes-web-sin-soporte/LV-ClientesWebSinSoporte /mnt/LV-ClientesWebSinSoporte

183
00:22:18,879 --> 00:22:24,699
$ sudo mount /dev/clientes-web-con-soporte/LV-ClientesWebConSoporte /mnt/LV-ClientesWebConSoporte

184
00:22:26,699 --> 00:22:34,019
En la siguiente imagen el administrador de archivos Nautilus nos informa de las propiedades del nuevo sistema de archivos.

185
00:22:36,019 --> 00:22:48,919
Hay que recordad que las carpetas usadas en el sistema operativo anfitrión para montar los nuevos dispositivos virtuales de almacenamiento son seleccionadas de forma arbitraria en este trabajo de prácticas con VLM. 

186
00:22:50,919 --> 00:23:06,459
En la realidad los nuevos sistemas de almacenamiento virtuales son asignadas o montados a carpetas de usuarios Linux específicos o carpetas publicas de la red Intranet corporativa o carpetas publicas expuestas a la red de Internet por medio de algún servicio.

187
00:23:08,459 --> 00:23:10,919
Práctica de asignar más espacio en un LVM

188
00:23:12,919 --> 00:23:13,339
Tareas:

189
00:23:15,339 --> 00:23:19,059
    • Tomar 30 Gigas de la partición de 73 Gigas sin asignar. 

190
00:23:21,059 --> 00:23:26,699
    • Agregar la nueva partición de 30 Gigas al grupo de PV llamado clientes-web-sin-soporte. 

191
00:23:28,699 --> 00:23:34,279
    • Sumar los 30 Gigas a los 50 Gigas existentes en el LV llamado LV-ClientesWebSinSoporte.

192
00:23:36,279 --> 00:23:40,839
Usamos Gparted, en lugar de fdisk, para crear la nueva partición de 50 Gigas

193
00:23:42,839 --> 00:23:44,339
Vemos la tarea realizadas

194
00:23:46,339 --> 00:23:56,299
Hacer Click con el botón derecho del ratón y formatear la nueva partición física con el formato ext4 o el formato lvm2 pv. en lugar de usar el comando mkfs.<formato>.

195
00:23:58,299 --> 00:24:06,879
Hay que tener en cuenta que Gparted le está dando formato a la partición física y no a los formatos internos del LVM para los PV, VG y los LV. 

196
00:24:08,879 --> 00:24:15,899
No confundir la tarea de darte formato a una partición física con Gparted con la tarea de darle formato a un LV.     

197
00:24:17,899 --> 00:24:21,979
Aplicar los cambios haciendo click en la palomita verde de Gparted. 

198
00:24:23,979 --> 00:24:26,799
La siguiente imagen muestra la tarea realizadas

199
00:24:28,799 --> 00:24:33,539
Ejecutar el siguiente comando para inicializar un PV dada una partición física.

200
00:24:35,539 --> 00:24:37,039
$ sudo pvcreate /dev/sda4

201
00:24:39,039 --> 00:24:39,639
$ sudo pvs

202
00:24:41,639 --> 00:24:49,379
Ejecutar el siguiente comando para agregar el PV, inicializado en la nueva partición, al grupo llamado clientes-web-sin-soporte. 

203
00:24:51,379 --> 00:24:54,379
$ sudo vgextend clientes-web-sin-soporte /dev/sda4

204
00:24:56,379 --> 00:24:58,899
$ sudo vgdisplay  clientes-web-sin-soporte

205
00:25:00,899 --> 00:25:04,559
Ejecutar el siguiente comando para extender un LV dado un VG.

206
00:25:06,559 --> 00:25:11,179
$ sudo lvextend -L+30G /dev/clientes-web-sin-soporte/LV-ClientesWebSinSoporte

207
00:25:13,179 --> 00:25:14,139
$ sudo lvdisplay

208
00:25:16,139 --> 00:25:21,059
En la siguiente imagen vemos la ejecución de los comandos en la terminal de Linux.

209
00:25:23,059 --> 00:25:27,979
Ahora hay que redimensionar el sistema de archivos para clientes-web-sin-soporte. 

210
00:25:29,979 --> 00:25:35,559
El comando $ sudo lsblk -f informará el tipo de archivo dentro del LVM, normalmente es ext4. 

211
00:25:37,559 --> 00:25:42,779
Para redimensionar un sistema de archivo del tipo ext4 ejecutar los siguientes comando:

212
00:25:44,779 --> 00:25:49,099
$ sudo e2fsck -f /dev/clientes-web-sin-soporte/LV-ClientesWebSinSoporte 

213
00:25:51,099 --> 00:25:55,359
$ sudo resize2fs /dev/clientes-web-sin-soporte/LV-ClientesWebSinSoporte

214
00:25:57,359 --> 00:26:00,179
El primer comando verifica que no hay errores. 

215
00:26:02,179 --> 00:26:06,559
El segundo comando hace la tarea de redimensionar el sistema de archivos.

216
00:26:08,559 --> 00:26:15,159
En la siguiente imagen vemos la ejecución de los comandos para redimensionar un sistema de archivos en el LVM.

217
00:26:17,159 --> 00:26:23,699
Verificamos la tarea realizada con Gparted y vemos que se han sumados los 30 Gigas a los 25 Gigas existente. 

218
00:26:25,699 --> 00:26:30,919
Todavía existe la posibilidad de seguir asignando espacio al LV con unos 43 Gigas más. 

219
00:26:32,919 --> 00:26:34,779
FIN ---------------------------

